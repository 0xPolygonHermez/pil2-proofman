require "std_constants.pil"
require "std_connection.pil"

// To audit:
// node ../pil2-compiler/src/pil.js ./pil2-components/test/std/one_instance/one_instance.pil -I ./pil2-components/lib/std/pil -o ./pil2-components/test/std/one_instance/build/build.pilout
// node --max-old-space-size=131072 ../pil2-compiler/tools/audit.js pil2-components/test/std/one_instance/build/build.pilout

// Set the std mode to one instance
set_std_mode(STD_MODE_ONE_INSTANCE);

airtemplate AirProd(const int N = 2**8) {
    col witness a,b,c;

    c === 0;

    permutation_assumes(0, [a], bus_type: PIOP_BUS_PROD);
    permutation_proves(0, [b], bus_type: PIOP_BUS_PROD);
}

airgroup OneInstanceProd {
    AirProd();
}

airtemplate AirSum(const int N = 2**8) {
    col witness a,b,c;

    c === 0;

    permutation_assumes(0, [a], bus_type: PIOP_BUS_SUM);
    permutation_proves(0, [b], bus_type: PIOP_BUS_SUM);
}

airgroup OneInstanceSum {
    AirSum();
}